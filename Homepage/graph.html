<!DOCTYPE html>
<html>
<head>
    <title>Data Analytics with Graph</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <style>
        /* Add some styling for the graph */
        #chart {
            width: 600px;
            height: 400px;
        }
    </style>
</head>
<body>
    <h1>Data Analytics with Graph</h1>

    <label for="startDate">Start Date:</label>
    <input type="text" id="startDate">

    <label for="endDate">End Date:</label>
    <input type="text" id="endDate">

    <button id="filterButton">Filter</button>

    <div id="chart"></div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.0.0/dist/d3.min.js"></script>
    <script>
        // Sample data for the graph
        const data = [
            { date: '2022-01-01', value: 50 },
            { date: '2022-02-01', value: 80 },
            { date: '2022-03-01', value: 60 },
            { date: '2022-04-01', value: 70 },
            { date: '2022-05-01', value: 90 },
            { date: '2022-06-01', value: 75 },
            { date: '2022-07-01', value: 100 },
            { date: '2022-08-01', value: 120 },
            { date: '2022-09-01', value: 95 },
            { date: '2022-10-01', value: 110 },
            { date: '2022-11-01', value: 130 },
            { date: '2022-12-01', value: 115 },
            { date: '2023-01-01', value: 140 },
            { date: '2023-02-01', value: 160 },
            { date: '2023-03-01', value: 145 }
        ];

        // Function to draw the bar graph
        function drawGraph(filteredData) {
            const svgWidth = 600;
            const svgHeight = 400;

            const margin = { top: 20, right: 20, bottom: 30, left: 40 };
            const width = svgWidth - margin.left - margin.right;
            const height = svgHeight - margin.top - margin.bottom;

            const svg = d3.select('#chart')
                .append('svg')
                .attr('width', svgWidth)
                .attr('height', svgHeight);

            const chart = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const xScale = d3.scaleBand()
                .range([0, width])
                .padding(0.1);

            const yScale = d3.scaleLinear()
                .range([height, 0]);

            xScale.domain(filteredData.map(d => d.date));
            yScale.domain([0, d3.max(filteredData, d => d.value)]);

            chart.append('g')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(xScale));

            chart.append('g')
                .call(d3.axisLeft(yScale));

            chart.selectAll('.bar')
                .data(filteredData)
                .enter()
                .append('rect')
                .attr('class', 'bar')
                .attr('x', d => xScale(d.date))
                .attr('y', d => yScale(d.value))
                .attr('width', xScale.bandwidth())
                .attr('height', d => height - yScale(d.value));
        }

        // Initialize the datepicker inputs
        $(document).ready(function () {
            $('#startDate').datepicker();
            $('#endDate').datepicker();
        });

        // Apply filters based on the selected date range
        $('#filterButton').click(function () {
            const startDate = $('#startDate').datepicker('getDate');
            const endDate = $('#endDate').datepicker('getDate');

            // Filter the data based on the date range
            const filteredData = data.filter(d => {
                const date = new Date(d.date);
                return date >= startDate && date <= endDate;
            });

            // Clear existing chart
            d3.select('#chart').selectAll('*').remove();

            // Draw the bar graph with the filtered data
            drawGraph(filteredData);
        });
    </script>
</body>
</html>
